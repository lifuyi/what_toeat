<view class="container"><view class="header"><view class="header-content"><view class="greeting-section"><text class="emoji">✨</text><text class="greeting-text">{{greeting+"，"+meal+"吃什么？"}}</text><text class="emoji">🍽️</text></view><block wx:if="{{showTestButton}}"><view data-event-opts="{{[['tap',[['goToApiTest',['$event']]]]]}}" class="test-api-btn" bindtap="__e"><text class="test-text">🔧 API测试</text></view></block><view class="date-info"><text class="date-text">{{currentDate}}</text></view><view class="tags"><view class="tag tag-ai">🤖 AI智能推荐</view><view class="tag tag-realtime">⚡ 实时更新</view><view class="tag tag-personal">🎯 个性化定制</view></view></view></view><view class="radar-preset-section"><text class="section-title">📊 口味偏好设置</text><view class="radar-preset-card"><canvas class="radar-canvas" style="{{'width:'+('300rpx')+';'+('height:'+('300rpx')+';')}}" type="2d" id="radarChart" data-event-opts="{{[['touchstart',[['onRadarTouch',['$event']]]],['touchmove',[['onRadarTouchMove',['$event']]]],['touchend',[['onRadarTouchEnd',['$event']]]]]}}" bindtouchstart="__e" bindtouchmove="__e" bindtouchend="__e"></canvas><view class="preset-buttons-area"><text class="preset-subtitle">🎯 快速预设，从左起：健康、辣食、方便，随机</text><view class="preset-row"><view data-event-opts="{{[['tap',[['selectHealthyPreset',['$event']]]]]}}" class="preset-icon-btn" bindtap="__e"><text class="preset-emoji">🥗</text></view><view data-event-opts="{{[['tap',[['selectSpicyPreset',['$event']]]]]}}" class="preset-icon-btn" bindtap="__e"><text class="preset-emoji">🌶️</text></view><view data-event-opts="{{[['tap',[['selectEasyPreset',['$event']]]]]}}" class="preset-icon-btn" bindtap="__e"><text class="preset-emoji">👨‍🍳</text></view><view data-event-opts="{{[['tap',[['randomRecommend',['$event']]]]]}}" class="preset-icon-btn preset-random" bindtap="__e"><text class="preset-emoji">🎲</text></view></view><text class="preset-subtitle">🔍 食材搜索</text><view class="search-row"><view class="search-input-wrapper"><input class="search-input" placeholder="输入您有的食材..." data-event-opts="{{[['confirm',[['handleSearch',['$event']]]],['input',[['__set_model',['','searchTerm','$event',[]]]]]]}}" value="{{searchTerm}}" bindconfirm="__e" bindinput="__e"/><block wx:if="{{searchTerm}}"><view data-event-opts="{{[['tap',[['clearSearch',['$event']]]]]}}" class="clear-btn" bindtap="__e">✕</view></block><button class="search-btn-inline" disabled="{{!$root.g0}}" data-event-opts="{{[['tap',[['handleSearch',['$event']]]]]}}" bindtap="__e"><block wx:if="{{isSearching}}"><text>🔍</text></block><block wx:else><text>🔍</text></block></button></view></view></view></view></view><view class="recommendations-section"><text class="section-title">🍳 为您推荐</text><block wx:if="{{loading}}"><view class="loading"><text>正在为您推荐美食...</text></view></block><block wx:else><view class="dish-grid"><block wx:for="{{$root.l1}}" wx:for-item="dish" wx:for-index="index" wx:key="id"><view data-event-opts="{{[['tap',[['viewDishDetail',['$0'],[[['recommendedDishes','id',dish.$orig.id]]]]]]]}}" class="{{['dish-card',(dish.$orig.matchScore>=80)?'high-match':'',(dish.$orig.matchScore>=60&&dish.$orig.matchScore<80)?'medium-match':'']}}" bindtap="__e"><view class="dish-header"><text class="dish-name">{{dish.$orig.name}}</text><block wx:if="{{dish.$orig.matchScore}}"><view class="match-score"><text class="score-text">{{dish.g1+"%匹配"}}</text></view></block></view><text class="dish-description">{{dish.$orig.description||'美味当家，点击查看详细做法...'}}</text><view class="dish-meta"><text class="meta-item">{{"⏱️ "+dish.$orig.cookingTime}}</text><text class="meta-item">{{"📊 "+dish.$orig.difficulty}}</text></view><block wx:if="{{dish.$orig.cid}}"><view class="dish-cid-tags"><block wx:for="{{dish.l0}}" wx:for-item="cidTag" wx:for-index="index" wx:key="index"><text class="cid-tag">{{cidTag}}</text></block></view></block></view></block></view></block></view><view class="favorites-section"><view class="section-header"><text class="section-title">❤️ 我的收藏</text><view data-event-opts="{{[['tap',[['loadFavorites',['$event']]]]]}}" class="refresh-btn" bindtap="__e"><text class="refresh-text">🔄</text></view></view><block wx:if="{{$root.g2>0}}"><view class="dish-grid"><block wx:for="{{$root.l2}}" wx:for-item="dish" wx:for-index="index" wx:key="id"><view data-event-opts="{{[['tap',[['viewDishDetail',['$0'],[[['favoriteDishes','id',dish.$orig.id]]]]]]]}}" class="dish-card favorite-card" bindtap="__e"><view class="dish-header"><text class="dish-name">{{dish.$orig.name}}</text><block wx:if="{{dish.$orig.matchScore}}"><view class="match-score"><text class="score-text">{{dish.g3+"%匹配"}}</text></view></block></view><text class="dish-description">{{dish.$orig.description||'美味当家，点击查看详细做法...'}}</text><view class="dish-meta"><text class="meta-item">{{"⏱️ "+dish.$orig.cookingTime}}</text><text class="meta-item">{{"📊 "+dish.$orig.difficulty}}</text></view></view></block></view></block><block wx:else><view class="no-favorites"><text class="no-favorites-text">还没有收藏的菜品，快去发现你喜欢的美食吧！</text></view></block></view></view>